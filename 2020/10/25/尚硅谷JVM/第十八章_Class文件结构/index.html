<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>尚硅谷JVM/第十八章_Class文件结构 - Code Dragon</title><meta description="Class 文件结构概述"><meta property="og:type" content="blog"><meta property="og:title" content="尚硅谷JVM/第十八章_Class文件结构"><meta property="og:url" content="https://sxlong0205.github.io/2020/10/25/%E5%B0%9A%E7%A1%85%E8%B0%B7JVM/%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0_Class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"><meta property="og:site_name" content="Code Dragon"><meta property="og:description" content="Class 文件结构概述"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201016175037.jpg"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201016175905.jpg"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201016180142.jpg"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201019171539.png"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201019172026.png"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201019172152.png"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201019173446.png"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201019180124.png"><meta property="og:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201020121337.png"><meta property="article:published_time" content="2020-10-25T14:48:02.000Z"><meta property="article:modified_time" content="2020-10-25T14:48:02.000Z"><meta property="article:author" content="Code Dragon"><meta property="article:tag" content="Class文件结构"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://gitee.com/xlshi/blog_img/raw/master/img/20201016175037.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sxlong0205.github.io/2020/10/25/%E5%B0%9A%E7%A1%85%E8%B0%B7JVM/%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0_Class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"},"headline":"Code Dragon","image":["https://gitee.com/xlshi/blog_img/raw/master/img/20201016175037.jpg","https://gitee.com/xlshi/blog_img/raw/master/img/20201016175905.jpg","https://gitee.com/xlshi/blog_img/raw/master/img/20201016180142.jpg","https://gitee.com/xlshi/blog_img/raw/master/img/20201019171539.png","https://gitee.com/xlshi/blog_img/raw/master/img/20201019172026.png","https://gitee.com/xlshi/blog_img/raw/master/img/20201019172152.png","https://gitee.com/xlshi/blog_img/raw/master/img/20201019173446.png","https://gitee.com/xlshi/blog_img/raw/master/img/20201019180124.png","https://gitee.com/xlshi/blog_img/raw/master/img/20201020121337.png"],"datePublished":"2020-10-25T14:48:02.000Z","dateModified":"2020-10-25T14:48:02.000Z","author":{"@type":"Person","name":"Code Dragon"},"description":"Class 文件结构概述"}</script><link rel="canonical" href="https://sxlong0205.github.io/2020/10/25/%E5%B0%9A%E7%A1%85%E8%B0%B7JVM/%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0_Class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/github.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Code Dragon" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-10-25T14:48:02.000Z" title="2020-10-25T14:48:02.000Z">2020-10-25</time><span class="level-item"><a class="link-muted" href="/categories/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/">Java虚拟机</a></span><span class="level-item">2 hours read (About 13554 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span> visits</span></div></div><h1 class="title is-3 is-size-4-mobile">尚硅谷JVM/第十八章_Class文件结构</h1><div class="content"><h1 id="Class-文件结构"><a href="#Class-文件结构" class="headerlink" title="Class 文件结构"></a>Class 文件结构</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><a id="more"></a>
<h3 id="字节码文件的跨平台性"><a href="#字节码文件的跨平台性" class="headerlink" title="字节码文件的跨平台性"></a>字节码文件的跨平台性</h3><ol>
<li><p><strong>Java 语言，跨平台的(write once, run anywhere)</strong></p>
<ul>
<li>当 Java 源代码成功编译成字节码后，如果想在不同的平台上面运行，则无须再次编译</li>
<li>这个优势不再那么吸引人了。Python、PHP、Perl、Ruby、Lisp 等有强大的解释器</li>
<li>跨平台似乎已经快称为一门语言必选的特性</li>
</ul>
</li>
<li><p><strong>Java 虚拟机：跨语言的平台</strong></p>
<p><strong>Java 虚拟机不和包括 Java 在内的任何语言绑定，它只与”Class 文件”这种特定的二进制文件格式所关联。</strong>无论使用何种语言进行软件开发， 只要能将源文件编译为正确的 Class 文件，那么这种语言就可以在 Java 虚拟机上执行，可以说，统一而强大的 Class 文件结构，就是 Java 虚拟机的基石、桥梁。</p>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201016175037.jpg" alt="中篇_第1章：JVM的平台无关性"></p>
<p><a href="https://docs.oracle.com/javase/specs/index.html">https://docs.oracle.com/javase/specs/index.html</a>，所有的 JVM 全部遵守 Java 虚拟机规范，也就是说所有的 JVM 环境都是一样的， 这样一来字节码文件可以在各种 JVM 上进行。</p>
</li>
<li><p><strong>想要让一个 Java 程序正确地运行在 JVM 中，Java 源码就是必须要被编译为符合 JVM 规范的字节码</strong></p>
<ul>
<li>前端编译器的主要任务就是负责将符合 Java 语法规范的 Java 代码转换为符合 JVM 规范的字节码文件</li>
<li>javac 是一种能够将 Java 源码编译为字节码的前端编译器</li>
<li>javac 编译器在将 Java 源码编译为一个有效的字节码文件过程中经历了4个步骤，分别是<strong>词法分析、语法分析、语义分析以及生成字节码。</strong></li>
</ul>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201016175905.jpg" alt="中篇_第1章：JVM结构"></p>
</li>
</ol>
<p>Oracle 的 JDK 软件包括两部分内容：</p>
<ul>
<li>一部分是将 Java 源代码编译成 Java 虚拟机的指令集的编译器</li>
<li>另一部分是用于实现 Java 虚拟机的运行时环境</li>
</ul>
<h3 id="Java-的前端编译器"><a href="#Java-的前端编译器" class="headerlink" title="Java 的前端编译器"></a>Java 的前端编译器</h3><p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201016180142.jpg" alt="中篇_第1章：理解执行引擎"></p>
<p>前端编译器 VS 后端编译器</p>
<p>Java 源代码的编译结果是字节码，那么肯定需要有一种编译器能够将 Java 源码编译为字节码，承担这个重要责任的就是配置在 path 环境变量中的 <strong>javac 编译器</strong>。javac 是一种能够将 Java 源码编译为字节码的<strong>前端编译器</strong>。</p>
<p>HotSpot VM 并没有强制要求前端编译器只能使用 javac 来编译字节码，其实只要编译结果符合 JVM 规范都可以被 JVM 所识别即可。在 Java 的前端编译器领域，除了 javac 之外，还有一种被大家经常用到的前端编译器，那就是内置在 Eclipse 中的 <strong>ECJ (Eclipse Compiler for Java)编译器</strong>。和 javac 的全量式编译不同，ECJ 是一种增量式编译器。</p>
<ul>
<li>在 Eclipse 中，当开发人员编写完代码后，使用”Ctrl + S”快捷键时，ECJ 编译器所采取的<strong>编译方案</strong>是把未编译部分的源码逐行进行编译，而非每次都全量编译。因此 ECJ 的编译效率会比 javac 更加迅速和高效，当然编译质量和 javac 相比大致还是一样的</li>
<li>ECJ 不仅是 Eclipse 的默认内置前端编译器，在 Tomcat 中同样也是使用 ECJ 编译器来编译 jsp 文件。由于 ECJ 编译器是采用 GPLv2 的开源协议进行源代码公开，所以，大家可以登录 Eclipse 官网下载 ECJ 编译器的源码进行二次开发</li>
<li>默认情况下，IntelliJ IDEA 使用 javac 编译器（还可以自己设置为 AspectJ 编译器 ajc）</li>
</ul>
<p>前端编译器并不会直接涉及编译优化等方面的技术，而是将这些具体优化细节移交给 HotSpot 的 JIT 编译器负责</p>
<h3 id="透过字节码指令看代码细节"><a href="#透过字节码指令看代码细节" class="headerlink" title="透过字节码指令看代码细节"></a>透过字节码指令看代码细节</h3><ol>
<li>BAT 面试题<ol>
<li>类文件结构有几个部分？</li>
<li>知道字节码吗？字节码都有哪些？Integer x = 5; int y = 5; 比较 x == y 都经过哪些步骤？</li>
</ol>
</li>
<li>代码举例</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer i1 = <span class="number">10</span>;</span><br><span class="line">        Integer i2 = <span class="number">10</span>;</span><br><span class="line">        System.out.println(i1 == i2);</span><br><span class="line">        </span><br><span class="line">        Integer i3 = <span class="number">128</span>;</span><br><span class="line">        Integer i4 = <span class="number">128</span>;</span><br><span class="line">        System.out.println(i3 == i4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="keyword">new</span> String(<span class="string">"hello"</span>) + <span class="keyword">new</span> String(<span class="string">"world"</span>);</span><br><span class="line">        String str1 = <span class="string">"helloworld"</span>;</span><br><span class="line">        System.out.println(str == str1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SonTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Father f = <span class="keyword">new</span> Son();</span><br><span class="line">        System.out.println(f.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Father</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.print();</span><br><span class="line">        x = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Father.x = "</span> + x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Son</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.print();</span><br><span class="line">        x = <span class="number">40</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Son.x = "</span> + x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201019171539.png" alt="image-20201019171538026"></p>
<h2 id="虚拟机的基石：Class-文件"><a href="#虚拟机的基石：Class-文件" class="headerlink" title="虚拟机的基石：Class 文件"></a>虚拟机的基石：Class 文件</h2><h3 id="字节码文件里是什么？"><a href="#字节码文件里是什么？" class="headerlink" title="字节码文件里是什么？"></a>字节码文件里是什么？</h3><p>源代码经过编译器编译之后便会生成一个字节码文件，字节码是一种二进制的类文件，它的内容是 JVM 的指令，而不像 C、C++ 经由编译器直接生成机器码</p>
<h3 id="什么事字节码指令-byte-code-？"><a href="#什么事字节码指令-byte-code-？" class="headerlink" title="什么事字节码指令(byte code)？"></a>什么事字节码指令(byte code)？</h3><p>Java 虚拟机的指令由一个字节长度的、代表着某种特定操作含义的<strong>操作码(opcode)</strong>以及跟随其后的零至多个代表此操作所需参数的<strong>操作数(operand)</strong>所构成。虚拟机中许多指令并不包含操作数，只有一个操作码</p>
<p>比如：</p>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201019172026.png" alt="image-20201019172025732"></p>
<h3 id="如何解读供虚拟机解释执行的二进制字节码？"><a href="#如何解读供虚拟机解释执行的二进制字节码？" class="headerlink" title="如何解读供虚拟机解释执行的二进制字节码？"></a>如何解读供虚拟机解释执行的二进制字节码？</h3><p>方式一：一个一个二进制的看，这里用到的是 Notepad++，需要安装一个 HEX-Editor 插件，或者使用 Binary Viewer</p>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201019172152.png" alt="image-20201019172151293"></p>
<p>方式二：使用 javap 指令，JDK 自带的反解析工具</p>
<p>方式三：使用 IDEA 插件，jclasslib 或 jclasslib bytecode viewer 客户端工具</p>
<h2 id="Class-文件结构-1"><a href="#Class-文件结构-1" class="headerlink" title="Class 文件结构"></a>Class 文件结构</h2><ul>
<li><strong>官方文档位置</strong></li>
</ul>
<p><a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html">https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html</a></p>
<ul>
<li><strong>Class 类的本质</strong></li>
</ul>
<p>任何一个 Class 文件都对应着唯一一个类或接口的定义信息，但反过来说，Class 文件实际上它并不一定以磁盘文件形式存在。Class 文件是一组以8位字节为基础单位的<strong>二进制流</strong></p>
<ul>
<li><strong>Class 文件格式</strong></li>
</ul>
<p>Class 的结构不像 XML 等描述语言，由于它没有任何分隔符号。所以在其中的数据项，无论是字节顺序还是数量，都是被严格限定的，哪个字节代表什么含义，长度是多少，先后顺序如何，都不允许改变</p>
<p>Class 文件格式采用一种类似于 C 语言结构体的方式进行数据存储，这种结构中只有两种数据类型：<strong>无符号数</strong>和<strong>表</strong></p>
<ol>
<li>无符号数属于基本的数据类型，以 u1、u2、u4、u8 来分别代表1个字节、2个字节、4个字节、8个字节的无符号数，无符号数可以用来描述数字、索引引用、数量值或者按照 UTF-8 编码构成字符串值</li>
<li>表是由多个无符号数或者其他表作为数据项构成的复合数据类型，所有表都习惯性地以”_info”结尾。表用于描述有层次关系的复合结构的数据，整个 Class 文件本质上就是一张表。由于表没有固定长度，所以通常会在其前面加上个数说明</li>
</ol>
<ul>
<li><strong>代码举例</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> num = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        num = num + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的字节码文件：</p>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201019173446.png" alt="image-20201019173445368"></p>
<p><strong>换句话说，充分理解了每一个字节码文件的细节，自己也可以反编译出 Java 源文件来</strong></p>
<ul>
<li><strong>Class 文件结构概述</strong></li>
</ul>
<p>Class 文件的结构并不是一成不变的，随着 Java 虚拟机的不断发展，总是不可避免地会对 Class 文件结构做出一些调整，但是其基本结构和框架是非常稳定的</p>
<p>Class 文件的总体结构如下：</p>
<ol>
<li>魔数</li>
<li>Class 文件版本</li>
<li>常量池</li>
<li>访问标志</li>
<li>类索引、父类索引、接口索引集合</li>
<li>字段表集合</li>
<li>方法表集合</li>
<li>属性表集合</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">说明</th>
<th style="text-align:center">长度</th>
<th style="text-align:center">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u4</td>
<td style="text-align:center">magic</td>
<td style="text-align:center">魔数,识别Class文件格式</td>
<td style="text-align:center">4个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">minor_version</td>
<td style="text-align:center">副版本号(小版本)</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">major_version</td>
<td style="text-align:center">主版本号(大版本)</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">constant_pool_count</td>
<td style="text-align:center">常量池计数器</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">cp_info</td>
<td style="text-align:center">constant_pool</td>
<td style="text-align:center">常量池表</td>
<td style="text-align:center">n个字节</td>
<td style="text-align:center">constant_pool_count-1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">access_flags</td>
<td style="text-align:center">访问标识</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">this_class</td>
<td style="text-align:center">类索引</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">super_class</td>
<td style="text-align:center">父类索引</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">interfaces_count</td>
<td style="text-align:center">接口计数器</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">interfaces</td>
<td style="text-align:center">接口索引集合</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">interfaces_count</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">fields_count</td>
<td style="text-align:center">字段计数器</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">field_info</td>
<td style="text-align:center">fields</td>
<td style="text-align:center">字段表</td>
<td style="text-align:center">n个字节</td>
<td style="text-align:center">fields_count</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">methods_count</td>
<td style="text-align:center">方法计数器</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">method_info</td>
<td style="text-align:center">methods</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">n个字节</td>
<td style="text-align:center">methods_count</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attributes_count</td>
<td style="text-align:center">属性计数器</td>
<td style="text-align:center">2个字节</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">attribute_info</td>
<td style="text-align:center">attributes</td>
<td style="text-align:center">属性表</td>
<td style="text-align:center">n个字节</td>
<td style="text-align:center">attributes_count</td>
</tr>
</tbody>
</table>
</div>
<h3 id="魔数：Class-文件的标志"><a href="#魔数：Class-文件的标志" class="headerlink" title="魔数：Class 文件的标志"></a>魔数：Class 文件的标志</h3><p>Magic Number(魔数)</p>
<ul>
<li>每个 Class 文件开头的4个字节的无符号整数称为魔数(Magic Number)</li>
<li>它的唯一作用是确定这个文件是否为一个能被虚拟机接受的有效合法的 Class 文件。即：魔数是 Class 文件的标识符</li>
<li>魔数值固定为 0xCAFEBABE。不会改变</li>
<li>如果一个 Class 文件不以 0xCAFEBABE 开头，虚拟机在进行文件校验的时候就会直接抛出以下错误：</li>
</ul>
<blockquote>
<p>Error: A JNI error has occurred, please check your installation and try again </p>
<p>Exception in thread “main” java.lang.ClassFormatError: Incompatible magic value 1885430635 in class file StringTest</p>
</blockquote>
<ul>
<li>使用魔数而不是扩展名来进行识别主要是基于安全方面的考虑，因为文件扩展名可以随意地改动</li>
</ul>
<h3 id="Class-文件版本号"><a href="#Class-文件版本号" class="headerlink" title="Class 文件版本号"></a>Class 文件版本号</h3><ul>
<li>紧接着魔数的4个字节存储的是 Class 文件的版本号。同样也是4个字节。第5个和第6个字节所代表的含义就是编译的副版本号 minor_version，而第7个和第8个字节就是编译的主版本号 major_version</li>
<li>它们共同构成了 Class 文件的格式版本号。譬如某个 Class 文件的主版本号为 M，服版本号为 m，那么这个 Class 文件的格式版本号就确定为 M.m</li>
<li>版本号和 Java 编译器的对应关系如下表：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">主版本（十进制）</th>
<th style="text-align:center">副版本（十进制）</th>
<th style="text-align:center">编译器版本</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">45</td>
<td style="text-align:center">3</td>
<td style="text-align:center">1.1</td>
</tr>
<tr>
<td style="text-align:center">46</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.2</td>
</tr>
<tr>
<td style="text-align:center">47</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.3</td>
</tr>
<tr>
<td style="text-align:center">48</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.4</td>
</tr>
<tr>
<td style="text-align:center">49</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.5</td>
</tr>
<tr>
<td style="text-align:center">50</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.6</td>
</tr>
<tr>
<td style="text-align:center">51</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.7</td>
</tr>
<tr>
<td style="text-align:center">52</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.8</td>
</tr>
<tr>
<td style="text-align:center">53</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.9</td>
</tr>
<tr>
<td style="text-align:center">54</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.10</td>
</tr>
<tr>
<td style="text-align:center">55</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1.11</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>Java 的版本号是从45开始的，JDK 1.1 之后的每个 JDK 大版本发布主版本号向上加1</li>
<li><strong>不同版本的 Java 编译器编译的 Class 文件对应的版本是不一样的。目前，高版本的 Java 虚拟机可以执行由低版本编译器生成的 Class 文件，但是低版本的 Java 虚拟机不能执行由高版本编译器生成的 Class 文件。否则 JVM 会抛出 <code>java.lang.UnsupportedClassVersionError</code> 异常(向下兼容)</strong></li>
<li>在实际应用中，由于开发环境和生产环境的不同，可能会导致该问题的发生。因此，需要我们在开发时，特别注意开发编译的 JDK 版本和生产环境的 JDK 版本是否一致<ul>
<li>虚拟机 JDK 版本为 1.k (k &gt;= 2)时，对应的 Class 文件格式版本号的范围为 45.0 - 44 + k.0(含两端)</li>
</ul>
</li>
</ul>
<h3 id="常量池：存放所有常量"><a href="#常量池：存放所有常量" class="headerlink" title="常量池：存放所有常量"></a>常量池：存放所有常量</h3><ul>
<li>常量池是 Class 文件中内容最为丰富的区域之一。常量池对于 Class 文件中的字段和方法解析也有着至关重要的作用</li>
<li>随着 Java 虚拟机的不断发展，常量池的内容也日渐丰富，可以说，常量池是整个 Class 文件的基石</li>
<li>在版本号之后，紧跟着的是常量池的数量，以及若干个常量池表项</li>
<li>常量池中常量的数量是不固定的，所以在常量池的入口需要放置一项 u2 类型的无符号数，代表常量池容量计数值(constant_pool_count)，与 Java 中语言习惯不一样的是，这个容量计数是从1而不是0开始的</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2(无符号数)</td>
<td style="text-align:center">constant_pool_count</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">cp_info(表)</td>
<td style="text-align:center">constant_pool</td>
<td style="text-align:center">constant_pool_count - 1</td>
</tr>
</tbody>
</table>
</div>
<p>由上表可见，Class 文件使用了一个前置的容量计数器(constant_pool_count)加若干个连续的数据项(constant_pool)的形式来描述常量池内容，我们把这一系列连续常量池数据称为常量池集合</p>
<ul>
<li><strong>常量池表项</strong>中，用于存放编译时期生成的各种<strong>字面量</strong>和<strong>符号引用</strong>，这部分内容将在类加载后进入方法区的<strong>运行时常量池</strong>中存放</li>
</ul>
<h4 id="常量池计数器：存放所有常量"><a href="#常量池计数器：存放所有常量" class="headerlink" title="常量池计数器：存放所有常量"></a>常量池计数器：存放所有常量</h4><ul>
<li>由于常量池的数量不固定，时长时短，所以需要放置两个字节来表示常量池容量计数值</li>
<li>常量池容量计数值(u2 类型)：从1开始，表示常量池中有多少项常量。即 constant_pool_count = 1 表示常量池中有0个常量项</li>
<li>Demo 的值为：</li>
</ul>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201019180124.png" alt="image-20201019180123341"></p>
<p>其值为 0x0016，对应的十进制值为22</p>
<p>需要注意的是，这实际上只有21项常量。索引为范围是1-21。为什么呢？</p>
<blockquote>
<p>通常我们写代码时都是从0开始的，但是这里的常量池却是从1开始，因为它把第0项常量空出来了。这是为了满足后面某些指向常量池的索引值的数据在特定情况下需要表达”不引用任何一个常量池项目”的含义，这种情况可用索引值0来表示</p>
</blockquote>
<h4 id="常量池表"><a href="#常量池表" class="headerlink" title="常量池表"></a>常量池表</h4><ul>
<li>constant_pool 是一种表结构，以 1 ~ constant_pool_count - 1 为索引。表明了后面有多少个常量项</li>
<li>常量池主要存放两大类常量：<strong>字面量(Literal)</strong>和<strong>符号引用(Symbolic References)</strong></li>
<li>它包含了 Class 文件结构及其子结构中引用的所有字符串常量、类或接口名、字段名和其他常量。常量池中的每一项都具备相同的特征。第1个字节作为类型标记，用于确定该项的格式，这个字节称为 tag byte(标记字节、标签字节)</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">标志(或标识)</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">CONSTANT_utf8_info</td>
<td style="text-align:center">1</td>
<td style="text-align:center">UTF-8编码的字符串</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Integer_info</td>
<td style="text-align:center">3</td>
<td style="text-align:center">整型字面量</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Float_info</td>
<td style="text-align:center">4</td>
<td style="text-align:center">浮点型字面量</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Long_info</td>
<td style="text-align:center">5</td>
<td style="text-align:center">长整型字面量</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Double_info</td>
<td style="text-align:center">6</td>
<td style="text-align:center">双精度浮点型字面量</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Class_info</td>
<td style="text-align:center">7</td>
<td style="text-align:center">类或接口的符号引用</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_String_info</td>
<td style="text-align:center">8</td>
<td style="text-align:center">字符串类型字面量</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Fieldref_info</td>
<td style="text-align:center">9</td>
<td style="text-align:center">字段的符号引用</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_Methodref_info</td>
<td style="text-align:center">10</td>
<td style="text-align:center">类中方法的符号引用</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_InterfaceMethodref_info</td>
<td style="text-align:center">11</td>
<td style="text-align:center">接口中方法的符号引用</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_NameAndType_info</td>
<td style="text-align:center">12</td>
<td style="text-align:center">字段或方法的符号引用</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_MethodHandle_info</td>
<td style="text-align:center">15</td>
<td style="text-align:center">表示方法句柄</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_MethodType_info</td>
<td style="text-align:center">16</td>
<td style="text-align:center">标志方法类型</td>
</tr>
<tr>
<td style="text-align:center">CONSTANT_InvokeDynamic_info</td>
<td style="text-align:center">18</td>
<td style="text-align:center">表示一个动态方法调用点</td>
</tr>
</tbody>
</table>
</div>
<h5 id="字面量和符号引用"><a href="#字面量和符号引用" class="headerlink" title="字面量和符号引用"></a>字面量和符号引用</h5><p>在对这些常量解读前，需要搞清楚几个概念</p>
<p>常量池主要存放两大类常量：字面量(Literal)和符号引用(Symbolic References)。如下表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">常量</th>
<th style="text-align:center">具体的常量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">字面量</td>
<td style="text-align:center">文本字符串</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">声明为 final 的常量值</td>
</tr>
<tr>
<td style="text-align:center">符号引用</td>
<td style="text-align:center">类和接口的全限定名</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">字段的名称和描述符</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">方法的名称和描述符</td>
</tr>
</tbody>
</table>
</div>
<h6 id="全限定名"><a href="#全限定名" class="headerlink" title="全限定名"></a>全限定名</h6><p>com/atguigu/test/Demo 这个就是类的全限定名，仅仅是把包的”.”替换成”/“，为了使连续的多个全限定名之间不产生混淆，在使用时最后一般会加入一个”;”表示全限定名结束</p>
<h6 id="简单名称"><a href="#简单名称" class="headerlink" title="简单名称"></a>简单名称</h6><p>简单名称是指没有类型和参数修饰的方法或者字段名称，上面例子中的类的 add() 方法和 num 字段的简单名称分别是 add 和 num</p>
<h6 id="描述符"><a href="#描述符" class="headerlink" title="描述符"></a>描述符</h6><p><strong>描述符的作用是用来描述字段的数据类型、方法的参数列表(包括数量、类型以及顺序)和返回值。</strong>根据描述符规则，基本数据类型(byte、char、double、float、int、long、short、boolean)以及代表无返回值的 void 类型都用一个大写字符来表示，而对象类型则用字符 L 加对象的全限定名表示，详见下表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志符</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">基本数据类型byte</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">基本数据类型char</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">基本数据类型double</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">基本数据类型float</td>
</tr>
<tr>
<td style="text-align:center">I</td>
<td style="text-align:center">基本数据类型int</td>
</tr>
<tr>
<td style="text-align:center">J</td>
<td style="text-align:center">基本数据类型long</td>
</tr>
<tr>
<td style="text-align:center">S</td>
<td style="text-align:center">基本数据类型short</td>
</tr>
<tr>
<td style="text-align:center">Z</td>
<td style="text-align:center">基本数据类型boolean</td>
</tr>
<tr>
<td style="text-align:center">V</td>
<td style="text-align:center">代表void类型</td>
</tr>
<tr>
<td style="text-align:center">L</td>
<td style="text-align:center">对象类型，比如：<code>Ljava/lang/Object;</code></td>
</tr>
<tr>
<td style="text-align:center">[</td>
<td style="text-align:center">数组类型，代表一维数组。比如：<code>double[][][] is [[[D</code></td>
</tr>
</tbody>
</table>
</div>
<p>用描述符来藐视方法时，按照先参数列表，后返回值的顺序描述，参数列表按照参数的严格顺序放在一组小括号”()”之内，如方法 <code>java.lang.String toString()</code>的描述符为 <code>() Ljava/lang/String;</code>，方法 <code>int abc(int[] x ,int y)</code>描述符为<code>([II) I</code></p>
<blockquote>
<p>虚拟机在加载 Class 文件时才会进行动态链接，也就是说，Class 文件中不会保存各个方法和字段的最终内存布局信息，因此，这些字段和方法的符号引用不经过转换是无法直接被虚拟机使用的。<strong>当虚拟机运行时，需要从常量池中获得对应的符号引用，再在类加载过程中的解析阶段将其替换为直接引用，并翻译到具体的内存地址中。</strong></p>
<p>这里说明下符号引用和直接引用的区别与关联：</p>
<ul>
<li>符号引用：符号引用以<strong>一组符号</strong>来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能无歧义地定位到目标即可。<strong>符号引用与虚拟机实现的内存布局无关</strong>，引用的目标并不一定已经加载到内存中</li>
<li>直接引用：直接引用可以是直接指<strong>向目标的指针、相对偏移量或是一个能间接定位到目标的句柄。直接引用是与虚拟机实现的内存布局相关的，</strong>同一个符号引用在不同虚拟机实例上翻译出来的直接引用一般不会相同。如果有了直接引用，那说明引用的目标必定已经存在于内存之中了。</li>
</ul>
</blockquote>
<h5 id="常量类型和结构"><a href="#常量类型和结构" class="headerlink" title="常量类型和结构"></a>常量类型和结构</h5><p>常量池中每一项常量都是一个表，JDK 1.7 之后共14种不同的表结构数据。如下表格所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志</th>
<th style="text-align:center">常量</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">细节</th>
<th style="text-align:center">长度</th>
<th style="text-align:center">细节描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">CONSTANT_utf8_info</td>
<td style="text-align:center">UTF-8编码的字符串</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为1</td>
</tr>
<tr>
<td style="text-align:center">length</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">UTF-8编码的字符串占用的字符数</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">bytes</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">长度为length的UTF-8编码的字符串</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">CONSTANT_Integer_info</td>
<td style="text-align:center">整型字面量</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为3</td>
</tr>
<tr>
<td style="text-align:center">bytes</td>
<td style="text-align:center">u4</td>
<td style="text-align:center">按照高位在前存储的int值</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">CONSTANT_Float_info</td>
<td style="text-align:center">浮点型字面量</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为4</td>
</tr>
<tr>
<td style="text-align:center">bytes</td>
<td style="text-align:center">u4</td>
<td style="text-align:center">按照高位在前存储的float值</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">CONSTANT_Long_info</td>
<td style="text-align:center">长整型字面量</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为5</td>
</tr>
<tr>
<td style="text-align:center">bytes</td>
<td style="text-align:center">u8</td>
<td style="text-align:center">按照高位在前存储的long值</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">CONSTANT_Double_info</td>
<td style="text-align:center">双精度浮点型字面量</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为6</td>
</tr>
<tr>
<td style="text-align:center">bytes</td>
<td style="text-align:center">u8</td>
<td style="text-align:center">按照高位在前存储的double值</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">CONSTANT_Class_info</td>
<td style="text-align:center">类或接口的符号引用</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为7</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向全限定名常量项的索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">CONSTANT_String_info</td>
<td style="text-align:center">字符串类型字面量</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为8</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向字符串字面量的索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">CONSTANT_Fieldref_info</td>
<td style="text-align:center">字段的符号引用</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为9</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向声明字段的类或接口描述符CONSTANT_Class_info的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向字段描述符CONSTANT_NameAndType的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">CONSTANT_Methodref_info</td>
<td style="text-align:center">类中方法的符号引用</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为10</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向声明方法的类描述符CONSTANT_Class_Info的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向名称及类型描述符CONSTANT_NameAndType的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">CONSTANT_InterfaceMethodref_info</td>
<td style="text-align:center">接口中方法的符号引用</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为11</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向声明方法的接口描述符CONSTANT_Class_Info的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向名称及类型描述符CONSTANT_NameAndType的索引项</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">CONSTANT_NameAndType_info</td>
<td style="text-align:center">字段或方法的符号引用</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为12</td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向该字段或方法名称常量项的索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">指向该字段或方法描述符常量项的索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">CONSTANT_MethodHandle_info</td>
<td style="text-align:center">表示方法句柄</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为15</td>
</tr>
<tr>
<td style="text-align:center">reference_kind</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值必须在1-9之间，它决定了方法句柄的类型方法句柄类型的值表示方法句柄的字节码行为</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">reference_index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">值必须是对常量池的有效索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">CONSTANT_MethodType_info</td>
<td style="text-align:center">标志方法类型</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为16</td>
</tr>
<tr>
<td style="text-align:center">descriptor_index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">值必须是对常量池的有效索引，常量池在该索引处的项必须是CONSTANT_Utf8_info结构，表示方法的描述符</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center">CONSTANT_InvokeDynamic_info</td>
<td style="text-align:center">表示一个动态方法调用点</td>
<td style="text-align:center">tag</td>
<td style="text-align:center">u1</td>
<td style="text-align:center">值为18</td>
</tr>
<tr>
<td style="text-align:center">bootstrap_method_attr</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">值必须是对当前Class文件中引导方法表的bootstrap_methods[]数组的有效索引</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">name_and_type_index</td>
<td style="text-align:center">u2</td>
<td style="text-align:center">值必须是对当前常量池的有效索引，常量池在该索引处的项必须是CONSTANT_NameAndType_Info结构，表示方法名和方法描述符</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>根据上图每个类型的描述我们也可以知道每个类型是用来描述常量池中那些内容(主要是字面量、符号引用)的。比如： CONSTANT_Integer_info 是用来描述常量池中字面量信息的，而且只是整型字面量信息</li>
<li>标志为15、16、18的常量项类型是用来支持动态语言调用的( JDK 1.7 时才加入)</li>
<li>细节说明<ul>
<li>CONSTANT_Class_info 结构用于表示类或接口</li>
<li>CONSTANT_Fieldref_info、CONSTANT_Methodref_info 和 CONSTANT_InterfaceMethodref_info 结构表示字段、方法和接口方法</li>
<li>CONSTANT_String_info 结构用于表示 String 类型的常量对象</li>
<li>CONSTANT_Integer_info 和 CONSTANT_Float_info 表示4字节(int 和 float)的数值常量</li>
<li>CONSTANT_Long_info 和 CONSTANT_Double_info 结构表示8字节(long 和 double)的数值常量<ul>
<li>在 Class 文件的常量池中，所有的8字节常量均占两个表成员(项)的空间，如果一个 CONSTANT_Long_info 或 CONSTANT_Double_info 结构的项在常量池表中的索引位 n，则常量池表中下一个可用项的索引位 n + 2，此时常量池表中索引为 n + 1，的项仍然有效但必须视为不可用的</li>
</ul>
</li>
<li>CONSTANT_NameAndType_info 结构用于表示字段或方法，但是和之前的3个结构不同，CONSTANT_NameAndType_info 结构没有知名该字段或方法所属的类或接口</li>
<li>CONSTANT_Utf8_info 用于表示字符常量的值</li>
<li>CONSTANT_MethodHandle_info 结构用于表示方法句柄</li>
<li>CONSTANT_MethodType_info 结构表示方法类型</li>
<li>CONSTANT_InvokeDynamic_info 结构用于表示 invokedynamic 指令所用到的引导方法(bootstrap method)、引导方法所用到的动态调用名称(dynamic invocation name)、参数和返回类型，并可以给引导方法传入一系列称为静态参数(static argument)的常量</li>
</ul>
</li>
<li>解析方式<ul>
<li>一个字节一个字节的解析</li>
<li>使用 javap 命令解析：javap -verbose Demo.class 或 jclasslib 工具会更方便</li>
</ul>
</li>
</ul>
<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><ul>
<li>这14种表(或者常量项结构)的共同点是：表开始的第一位是一个 u1 类型的标志位(tag)，代表当前这个常量项使用的是哪种表结构，即哪种常量类型</li>
<li>在常量池列表中，CONSTANT_Utf8_info 常量项是一种使用改进过的 UTF-8 编码格式来存储诸如文字字符串、类或者接口的全限定名、字段或者方法的简单名称以及描述符等常量字符串信息</li>
<li>这14种常量项结构还有一个特点是，其中13个常量项占用的字节固定，只有 CONSTANT_Utf8_info 占用字节不固定，其大小由 length 决定。为什么？<strong>因为从常量池存放的内容可知，其存放的是字面量和符号引用，最终这些内容都会是一个字符串，这些字符串的大小是在编写程序时才确定，</strong>比如你定义一个类，类名可以取长去短，所以在没编译前，大小不固定，编译后，通过 UTF-8 编码，就可以知道其长度</li>
<li>常量池：可以理解为 Class 文件之中的资源仓库，它是 Class 文件结构中与其他项目关联最多的数据类型(后面的很多数据类型都会指向此处)，也是占用 Class 文件空间最大的数据项目之一</li>
<li>常量池中为什么包含这些内容</li>
</ul>
<blockquote>
<p>Java 代码在进行 javac 编译的时候，并不像 C 和 C++ 那样有”连接”这一步骤，而是在虚拟机加载 Class 文件的时候进行动态链接。也就是说，<strong>在 Class 文件中不会保存各个方法、字段的最终内存布局信息，因此这些字段、方法的符号引用不经过运行期转换的话无法得到真正的内存入口地址，也就无法直接被虚拟机使用。</strong>当虚拟机运行时，需要从常量池获得对应的符号引用，再在类创建时或运行时解析、翻译到具体的内存地址之中。</p>
</blockquote>
<h3 id="访问标识"><a href="#访问标识" class="headerlink" title="访问标识"></a>访问标识</h3><ul>
<li>在常量池后，紧跟着访问标记。该标记使用两个字节表示，用于识别一些类或者接口层次的访问信息，包括：这个 Class 是类还是接口；是否定义为 public 类型；是否定义为 abstract 类型；如果是类的话，是否被声明为 final 等。各种访问标记如下所示：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志名称</th>
<th style="text-align:center">标志值</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ACC_PUBLIC</td>
<td style="text-align:center">0x0001</td>
<td style="text-align:center">标志为public类型</td>
</tr>
<tr>
<td style="text-align:center">ACC_FINAL</td>
<td style="text-align:center">0x0010</td>
<td style="text-align:center">标志被声明为final，只有类可以设置</td>
</tr>
<tr>
<td style="text-align:center">ACC_SUPER</td>
<td style="text-align:center">0x0020</td>
<td style="text-align:center">标志允许使用invokespecial字节码指令的新语义，JDK1.0.2之后编译出来的类的这个标志默认为真。（使用增强的方法调用父类方法）</td>
</tr>
<tr>
<td style="text-align:center">ACC_INTERFACE</td>
<td style="text-align:center">0x0200</td>
<td style="text-align:center">标志这是一个接口</td>
</tr>
<tr>
<td style="text-align:center">ACC_ABSTRACT</td>
<td style="text-align:center">0x0400</td>
<td style="text-align:center">是否为abstract类型，对于接口或者抽象类来说，次标志值为真，其他类型为假</td>
</tr>
<tr>
<td style="text-align:center">ACC_SYNTHETIC</td>
<td style="text-align:center">0x1000</td>
<td style="text-align:center">标志此类并非由用户代码产生（即：由编译器产生的类，没有源码对应）</td>
</tr>
<tr>
<td style="text-align:center">ACC_ANNOTATION</td>
<td style="text-align:center">0x2000</td>
<td style="text-align:center">标志这是一个注解</td>
</tr>
<tr>
<td style="text-align:center">ACC_ENUM</td>
<td style="text-align:center">0x4000</td>
<td style="text-align:center">标志这是一个枚举</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>类的访问权限通常为 ACC_ 开头的常量</li>
<li>每一个种类型的表示都是通过设置访问标记的32位中的特定位来实现的。比如，若是 public final 的类，则该标记为 ACC_PUBLIC | ACC_FINAL</li>
<li>使用 ACC_SUPER 可以让类更准确地定位到父类的方法 super.method()，现代编译器都会设置并且使用这个标记</li>
</ul>
<blockquote>
<ol>
<li>带有 ACC_INTERFACE 标志的 Class 文件表示的是接口而不是类，反之则表示的是类而不是接口<ol>
<li>如果一个 Class 文件被设置了 ACC_INTERFACE 标志，那么同时也得设置 ACC_ABSTRACT 标志。同时它不能再设置 ACC_FINAL、ACC_SUPER 或 ACC_ENUM 标志</li>
<li>如果没有设置 ACC_INTERFACE 标志，那么这个 Class 问价可以具有上表中除 ACC_ANNOTATION 外的其他所有标志。当然，ACC_FINAL 和 ACC_ABSTRACT 这类互斥的标志除外。这两个标志不能同时设置</li>
</ol>
</li>
<li>ACC_SUPER 标志用于确定类或接口里面的 invokespecial 指令使用的是哪一种执行语义。<strong>针对 Java 虚拟机指令集的编译器都应当设置这个标志。</strong>对于 Java SE 8 及后续版本来说，无论 Class 文件中这个标志的实际值是什么，也不管 Class 文件的版本</li>
<li>ACC_SYNTHETIC 标志意味着该类或接口是由编译器生成的，而不是由源代码生成的</li>
<li>注解类型必须设置 ACC_ANNOTATION 标志。如果设置了 ACC_ANNOTATION 标志，那么也必须设置 ACC_INTERFACE 标志</li>
<li>ACC_ENUM 标志标明该类或其父类为枚举类型</li>
<li>表中没有使用的 access_flags 标志是为未来扩充而预留的，这些预留的标志在编译器中应该设置为0，Java 虚拟机实现也应该忽略他们</li>
</ol>
</blockquote>
<h3 id="类索引、父类索引、接口索引集合"><a href="#类索引、父类索引、接口索引集合" class="headerlink" title="类索引、父类索引、接口索引集合"></a>类索引、父类索引、接口索引集合</h3><ul>
<li>在访问标记后，会指定该类的类别、父类类别以及实现的接口，格式如下：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">长度</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">this_class</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">super_class</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">interfaces_count</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">interfaces[interfaces_count]</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>这三项数据来确定这个类的继承关系<ul>
<li>类索引用于确定这个类的全限定名</li>
<li>父类索引用于确定这个类的父类的全限定名。由于 Java 语言不允许多重继承，所以父类索引只有一个，除了 java.lang.Object 之外，所有的 Java 类都有父类，因此除了 java.lang.Object 外，所有 Java 类的父类索引都不为0</li>
<li>接口索引集合就用来描述这个类实现了哪些接口，这些被实现的接口将按 implements 语句(如果这个类本身是一个接口，则应当是 extends 语句)后的接口顺序从左到右排列在接口索引集合中</li>
</ul>
</li>
</ul>
<ol>
<li>this_class(类索引)</li>
</ol>
<p>2字节无符号整数，指向常量池的索引。它提供了类的全限定名，如com/atguigu/java1/Demo。this_class 的值必须是对常量池表中某项的一个有效索引值。常量池在这个索引处的成员必须为 CONSTANT_Class_info 类型结构体，该结构体表示这个 Class 文件所定义的类或接口</p>
<ol>
<li>super_class(父类索引)</li>
</ol>
<ul>
<li>2字节无符号整数，指向常量池的索引。它提供了当前类的父类的全限定名。如果我们没有继承任何类，其默认继承的是 java/lang/Object 类。同时，由于 Java 不支持多继承，所以其父类只有一个</li>
<li>superclass 指向的父类不能是 final</li>
</ul>
<ol>
<li>interfaces</li>
</ol>
<ul>
<li><p>指向常量池索引集合，它提供了一个符号引用到所有已实现的接口</p>
</li>
<li><p>由于一个类可以实现多个接口，因此需要以数组形式保存多个接口的索引，表示接口的每个索引也是一个指向常量池的 CONSTANT_Class(当然这里就必须是接口，而不是类)</p>
<p>3.1 interfaces_count(接口计数器)</p>
<p>interfaces_count 项的值表示当前类或接口的直接超接口数量</p>
<p>3.2 interface[] (接口索引集合)</p>
<p>interfaces[] 中每个成员的值必须是对常量池表中某项的有效索引值，它的长度为 interfaces_count。每个成员interfaces[i] 必须为 CONSTANT_Class_info 结构，其中 0 &lt;= i &lt; interfaces_count。在 interfaces[] 中，各成员所表示的接口顺序和对应的源代码中给定的接口顺序(从左至右)一样，即 interfaces[0] 对应的是源代码中最左边的接口</p>
</li>
</ul>
<h3 id="字段表集合-Fields"><a href="#字段表集合-Fields" class="headerlink" title="字段表集合(Fields)"></a>字段表集合(Fields)</h3><ul>
<li>用于描述接口或类中声明的变量。字段(field)包括<strong>类级变量以及实例级变量</strong>，但是不包括方法内部、代码块内部声明的局部变量</li>
<li>字段叫什么名字、字段被定义为什么数据类型，这些都是无法固定的，只能引用常量池中的常量来描述</li>
<li>它指向常量池索引集合，它描述了每个字段的完整信息。比如<strong>字段的标识符、访问修饰符(public、private 或 protected)、是类变量还是实例变量(static 修饰符)、是否是常量(final 修饰符)</strong>等。</li>
</ul>
<blockquote>
<p>注意事项：</p>
<ul>
<li>字段表集合中不会列出从父类或者实现的接口中继承而来的字段，但有可能列出原 Java 代码中不存在的字段，譬如在内部类中为了保持对外部类的方文星，会自动添加指向外部类实例的字段</li>
<li>在 Java 语言中字段是无法重载的，两个字段的数据类型、修饰符不管是否相同，都必须使用不一样的名称，但是对于字节码来讲，如果两个字段的描述符不一致，那字段重名就是合法的</li>
</ul>
</blockquote>
<h4 id="字段计数器-fields-count"><a href="#字段计数器-fields-count" class="headerlink" title="字段计数器(fields_count)"></a>字段计数器(fields_count)</h4><p>fields_count 的值表示当前 Class 文件 fields 表的成员个数。使用两个字节来表示</p>
<p>fields 表中每个成员都是一个 field_info 结构，用于表示该类或接口所声明的所有类字段或者实例字段，不包括方法内部声明的变量，也不包括从父类或父接口继承的那些字段</p>
<h4 id="fields-字段表"><a href="#fields-字段表" class="headerlink" title="fields [] (字段表)"></a>fields [] (字段表)</h4><p>fields 表中的每个成员都必须是一个 fields_info 结构的数据项，用于表示当前类或接口中某个字段的完整描述</p>
<p>一个字段的信息包括如下这些信息，这些信息中，<strong>各个修饰符都是布尔值，要么有，要么没有</strong></p>
<ul>
<li>作用域(public、private、protected 修饰符)</li>
<li>是实例变量还是类变量(static 修饰符)</li>
<li>可变性(final)</li>
<li>并发可见性(volatile 修饰符，是否强制从主内存读写)</li>
<li>可否序列化(transient 修饰符)</li>
<li>字段数据类型(基本数据类型、对象、数组)</li>
<li>字段名称</li>
</ul>
<p>字段表结构：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">含义</th>
<th style="text-align:center">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">access_flags</td>
<td style="text-align:center">访问标志</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">name_index</td>
<td style="text-align:center">字段名索引</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">descriptor_index</td>
<td style="text-align:center">描述符索引</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attributes_count</td>
<td style="text-align:center">属性计数器</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">attribute_info</td>
<td style="text-align:center">attributes</td>
<td style="text-align:center">属性集合</td>
<td style="text-align:center">attributes_count</td>
</tr>
</tbody>
</table>
</div>
<h5 id="字段表访问标识"><a href="#字段表访问标识" class="headerlink" title="字段表访问标识"></a>字段表访问标识</h5><p>我们知道，一个字段可以被各种关键字去修饰，比如：作用域修饰符(public、private、protected)、static 修饰符、final 修饰符、volatile 修饰符等等。因此，其可像类的访问标志那样，使用一些标志来标记字段。字段的访问标志有如下这些：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志名称</th>
<th style="text-align:center">标志值</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ACC_PUBLIC</td>
<td style="text-align:center">0x0001</td>
<td style="text-align:center">字段是否为public</td>
</tr>
<tr>
<td style="text-align:center">ACC_PRIVATE</td>
<td style="text-align:center">0x0002</td>
<td style="text-align:center">字段是否为private</td>
</tr>
<tr>
<td style="text-align:center">ACC_PROTECTED</td>
<td style="text-align:center">0x0004</td>
<td style="text-align:center">字段是否为protected</td>
</tr>
<tr>
<td style="text-align:center">ACC_STATIC</td>
<td style="text-align:center">0x0008</td>
<td style="text-align:center">字段是否为static</td>
</tr>
<tr>
<td style="text-align:center">ACC_FINAL</td>
<td style="text-align:center">0x0010</td>
<td style="text-align:center">字段是否为final</td>
</tr>
<tr>
<td style="text-align:center">ACC_VOLATILE</td>
<td style="text-align:center">0x0040</td>
<td style="text-align:center">字段是否为volatile</td>
</tr>
<tr>
<td style="text-align:center">ACC_TRANSTENT</td>
<td style="text-align:center">0x0080</td>
<td style="text-align:center">字段是否为transient</td>
</tr>
<tr>
<td style="text-align:center">ACC_SYNCHETIC</td>
<td style="text-align:center">0x1000</td>
<td style="text-align:center">字段是否为由编译器自动产生</td>
</tr>
<tr>
<td style="text-align:center">ACC_ENUM</td>
<td style="text-align:center">0x4000</td>
<td style="text-align:center">字段是否为enum</td>
</tr>
</tbody>
</table>
</div>
<h5 id="字段名索引"><a href="#字段名索引" class="headerlink" title="字段名索引"></a>字段名索引</h5><p>根据字段名索引的值，查询常量池中的指定索引项即可</p>
<h5 id="描述符索引"><a href="#描述符索引" class="headerlink" title="描述符索引"></a>描述符索引</h5><p>描述符的作用是用来描述字段的数据类型、方法的参数列表(包括数量、类型以及顺序)和返回值。根据描述符规则，基本数据类型(byte、char、double、float、int、long、short、boolean)及代表无返回值的 void 类型都用一个大写字符来表示，而对象则用字符L加对象的全限定名来表示，如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志符</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">基本数据类型 byte</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">基本数据类型 char</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">基本数据类型 double</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">基本数据类型 float</td>
</tr>
<tr>
<td style="text-align:center">I</td>
<td style="text-align:center">基本数据类型 int</td>
</tr>
<tr>
<td style="text-align:center">J</td>
<td style="text-align:center">基本数据类型 long</td>
</tr>
<tr>
<td style="text-align:center">S</td>
<td style="text-align:center">基本数据类型 short</td>
</tr>
<tr>
<td style="text-align:center">Z</td>
<td style="text-align:center">基本数据类型 boolean</td>
</tr>
<tr>
<td style="text-align:center">V</td>
<td style="text-align:center">代表 void 类型</td>
</tr>
<tr>
<td style="text-align:center">L</td>
<td style="text-align:center">对象类型，比如：<code>Ljava/lang/Object;</code></td>
</tr>
<tr>
<td style="text-align:center">[</td>
<td style="text-align:center">数组类型，代表一维数组。比如：<code>double[][][] is [[[D</code></td>
</tr>
</tbody>
</table>
</div>
<h5 id="属性表集合"><a href="#属性表集合" class="headerlink" title="属性表集合"></a>属性表集合</h5><p>一个字段还可能拥有一些属性，用于存储更多的额外信息。比如初始化值、一些注释信息等。属性个数存放在 attribute_count 中，属性具体内容存放在 attributes 数组中</p>
<p>以常量属性为例，结构为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ConstantValue_attribute &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">    u2 constantvalue_index;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">说明：对于常量属性而言，attribute_length 值恒为<span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="方法表集合"><a href="#方法表集合" class="headerlink" title="方法表集合"></a>方法表集合</h3><p>methods: 指向常量池索引集合，它完整描述了每个方法的签名</p>
<ul>
<li>在字节码文件中，每一个 method_info 项都对应着一个类或者接口中的方法信息。比如方法的访问修饰符(public、private 或 protected)，方法的返回值类型以及方法的参数信息等</li>
<li>如果这个方法不是抽象的或者不是 native 的，那么字节码中会体现出来</li>
<li>一方面，methods 表只描述当前类或接口中声明的方法，不包括从父类或父接口继承的方法。另一方面，methods 表有可能会出现由编译器自动添加的方法，最典型的便是编译器产生的方法信息(比如：类(接口)初始化方法 <clinit>() 和实例初始化方法 <init>()</li>
</ul>
<blockquote>
<p>使用注意事项：</p>
<p>在 Java 语言中，要重载(Overload)一个方法，除了要与原方法具有相同的简单名称之外，还要求必须拥有一个与原方法不同的特征签名，特征签名就是一个方法中各个参数在常量池中的字段符号引用的集合，也就是因为返回值不会包含在特征签名之中，因此 Java 语言里无法仅仅依靠返回值的不同来对一个已有方法进行重载。但在 Class 文件格式中，特征签名的范围更大一些，只要描述符不是完全一致的两个方法就可以共存。也就是说，如果两个方法有相同的名称和特征签名，但返回值不同，那么也是可以合法共存于同一个 Class 文件中。</p>
<p>也就是说，尽管 Java 语法规范并不允许在一个类或者接口中声明多个方法签名相同的方法，但是和 Java 语法规范相反，字节码文件中却恰恰允许存放多个方法签名相同的方法，唯一的条件就是这些方法之间的返回值不能相同。</p>
</blockquote>
<h4 id="methods-count-方法计数器"><a href="#methods-count-方法计数器" class="headerlink" title="methods_count(方法计数器)"></a>methods_count(方法计数器)</h4><p>methods_count 的值表示当前 Class 文件 methods 表的成员个数，使用两个字节来表示</p>
<p>methods 表中每个成员都是一个 method_info 结构</p>
<h4 id="methods-方法表"><a href="#methods-方法表" class="headerlink" title="methods[] (方法表)"></a>methods[] (方法表)</h4><ul>
<li>methods 表中的每个成员都必须是一个 method_info 结构，用于表示当前类或接口中某个方法的完整描述。如果某个 method_info 结构的 access_flags 项既没有设置 ACC_NATIVE 标志也没有设置 ACC_ABSTRACT 标志，那么该结构中也应包含实现这个方法所有的 Java 虚拟机指令</li>
<li>method_info 结构可以表示类和接口中定义的所有方法，包括实例方法、类方法、实例初始化方法和类或接口初始化方法</li>
<li>方法表的结构实际跟字段表是一样的，方法表结构如下：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">含义</th>
<th style="text-align:center">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">access_flags</td>
<td style="text-align:center">访问标志</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">name_index</td>
<td style="text-align:center">方法名索引</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">descriptor_index</td>
<td style="text-align:center">描述符索引</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attributes_count</td>
<td style="text-align:center">属性计数器</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">attribute_info</td>
<td style="text-align:center">attributes</td>
<td style="text-align:center">属性集合</td>
<td style="text-align:center">attributes_count</td>
</tr>
</tbody>
</table>
</div>
<h5 id="方法表访问标志"><a href="#方法表访问标志" class="headerlink" title="方法表访问标志"></a>方法表访问标志</h5><p>跟字段表一样，方法表也有访问标志，而且他们的标志有部分相同，部分则不同，方法表的具体访问标志如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标记名</th>
<th style="text-align:center">值</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ACC_PUBLIC</td>
<td style="text-align:center">0x0001</td>
<td style="text-align:center">public，方法可以从包外访问</td>
</tr>
<tr>
<td style="text-align:center">ACC_PRIVATE</td>
<td style="text-align:center">0x0002</td>
<td style="text-align:center">private，方法只能本类中访问</td>
</tr>
<tr>
<td style="text-align:center">ACC_PROTECTED</td>
<td style="text-align:center">0X0004</td>
<td style="text-align:center">protected，方法在自身和子类可以访问</td>
</tr>
<tr>
<td style="text-align:center">ACC_STATIC</td>
<td style="text-align:center">0x0008</td>
<td style="text-align:center">static，静态方法</td>
</tr>
</tbody>
</table>
</div>
<h3 id="属性表结合"><a href="#属性表结合" class="headerlink" title="属性表结合"></a>属性表结合</h3><p>方法表集合之后的属性表集合，<strong>指的是 Class 文件所携带的辅助信息</strong>，比如该 Class 文件的源文件的名称。以及任何带有 RetentionPolicy.CLASS 或者 RetentionPolicy.RUNTIME 的注解。这类信息通常被用于 Java 虚拟机的验证和运行，以及 Java 程序的调试，<strong>一般无需深入了解</strong></p>
<p>此外，字段表、方法表都可以有自己的属性表。用于描述某些场景专有的信息</p>
<p>属性表集合的限制没有那么严格，不再要求各个属性表具有严格的顺序，并且只要不与已有的属性名重复，任何人实现的编译器都可以向属性表中写入自己定义的属性信息，但 Java 虚拟机运行时会忽略掉它不认识的属性</p>
<h4 id="attributes-count-属性计数器"><a href="#attributes-count-属性计数器" class="headerlink" title="attributes_count(属性计数器)"></a>attributes_count(属性计数器)</h4><p>attributes_count 的值表示当前 Class 文件属性表的成员个数。属性表中每一项都是一个 attribute_info 结构</p>
<h4 id="attributes-属性表"><a href="#attributes-属性表" class="headerlink" title="attributes[] (属性表)"></a>attributes[] (属性表)</h4><p>属性表的每个项的值必须是 attribute_info 结构。属性表的结构比较灵活，各种不同的属性只要满足以下结构即可</p>
<h5 id="属性的通用格式"><a href="#属性的通用格式" class="headerlink" title="属性的通用格式"></a>属性的通用格式</h5><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">数量</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attribute_name_index</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性名索引</td>
</tr>
<tr>
<td style="text-align:center">u4</td>
<td style="text-align:center">attribute_length</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性长度</td>
</tr>
<tr>
<td style="text-align:center">u1</td>
<td style="text-align:center">info</td>
<td style="text-align:center">attribute_length</td>
<td style="text-align:center">属性表</td>
</tr>
</tbody>
</table>
</div>
<p>即只需说明属性的名称以及占用位数的长度即可，属性表具体的结构可以去自定义</p>
<h5 id="属性类型"><a href="#属性类型" class="headerlink" title="属性类型"></a>属性类型</h5><p>属性表实际上可以有很多类型，上面看到的 Code 属性只是其中一种， Java 8 里面定义了23种属性</p>
<p>下面这些是虚拟机中预定义的属性：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">属性名称</th>
<th style="text-align:center">使用位置</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Code</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">Java 代码编译成的字节码指令</td>
</tr>
<tr>
<td style="text-align:center">ConstantValue</td>
<td style="text-align:center">字段表</td>
<td style="text-align:center">final 关键字定义的常量池</td>
</tr>
<tr>
<td style="text-align:center">Deprecated</td>
<td style="text-align:center">类、方法、字段表</td>
<td style="text-align:center">被声明为 deprecated 的方法和字段</td>
</tr>
<tr>
<td style="text-align:center">Exceptions</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">方法抛出的异常</td>
</tr>
<tr>
<td style="text-align:center">EnclosingMethod</td>
<td style="text-align:center">类文件</td>
<td style="text-align:center">仅当一个类为局部类或者匿名类时才能拥有这个属性，这个属性用于标识这个类所在的外围方法</td>
</tr>
<tr>
<td style="text-align:center">InnerClass</td>
<td style="text-align:center">类文件</td>
<td style="text-align:center">内部类列表</td>
</tr>
<tr>
<td style="text-align:center">LineNumberTable</td>
<td style="text-align:center">Code 属性</td>
<td style="text-align:center">Java 源码的行号与字节码指令的对应关系</td>
</tr>
<tr>
<td style="text-align:center">LocalVariableTable</td>
<td style="text-align:center">Code 属性</td>
<td style="text-align:center">方法的局部变量描述</td>
</tr>
<tr>
<td style="text-align:center">StackMapTable</td>
<td style="text-align:center">Code 属性</td>
<td style="text-align:center">JDK 1.6 中新增的属性，供新的类型检查检验器检查和处理目标方法的局部变量和操作数所需要的类是否匹配</td>
</tr>
<tr>
<td style="text-align:center">Signature</td>
<td style="text-align:center">类、方法表、字段表</td>
<td style="text-align:center">用于支持泛型情况下的方法签名</td>
</tr>
<tr>
<td style="text-align:center">SourceFile</td>
<td style="text-align:center">类文件</td>
<td style="text-align:center">记录源文件名称</td>
</tr>
<tr>
<td style="text-align:center">SourceDebugExtension</td>
<td style="text-align:center">类文件</td>
<td style="text-align:center">用于存储额外的调试信息</td>
</tr>
<tr>
<td style="text-align:center">Synthetic</td>
<td style="text-align:center">类、方法表、字段表</td>
<td style="text-align:center">标志方法或字段为编译器自动生成的</td>
</tr>
<tr>
<td style="text-align:center">LocalVariableTypeTable</td>
<td style="text-align:center">类</td>
<td style="text-align:center">使用特征签名代替描述符，是为了引入泛型语法之后能描述泛型参数化类型而添加</td>
</tr>
<tr>
<td style="text-align:center">RuntimeVisibleAnnotations</td>
<td style="text-align:center">类、方法表、字段表</td>
<td style="text-align:center">为动态注解提供支持</td>
</tr>
<tr>
<td style="text-align:center">RuntimeInvisibleAnnotations</td>
<td style="text-align:center">表、方法表、字段表</td>
<td style="text-align:center">用于指明哪些注解是运行时不可见的</td>
</tr>
<tr>
<td style="text-align:center">RuntimeVisibleParameterAnnotation</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">作用与 RuntimeVisibleAnnotations 属性类似，只不过作用对象为方法</td>
</tr>
<tr>
<td style="text-align:center">RuntimeInvisibleParameterAnnotation</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">作用与 RuntimeInvisibleAnnotations 属性类似，作用对象哪个为方法参数</td>
</tr>
<tr>
<td style="text-align:center">AnnotationDefault</td>
<td style="text-align:center">方法表</td>
<td style="text-align:center">用于记录注解类元素的默认值</td>
</tr>
<tr>
<td style="text-align:center">BootstrapMethods</td>
<td style="text-align:center">类文件</td>
<td style="text-align:center">用于保存 invokeddynamic 指令引用的引导方式限定符</td>
</tr>
</tbody>
</table>
</div>
<h5 id="部分属性详解"><a href="#部分属性详解" class="headerlink" title="部分属性详解"></a>部分属性详解</h5><ul>
<li>ConstantValue 属性</li>
</ul>
<p>ConstantValue 属性表示一个常量字段的值。位于 field_info 结构的属性表中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ConstantValue_attribute &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">    u2 constantvalue_index; <span class="comment">//字段值在常量池中的索引，常量池在该索引处的项给出该属性表示的常量值。(例如，值是 long 型的，在常量池中便是 CONSTANT_Long)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Deprecated 属性</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Deprecated_attribute &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Code 属性</li>
</ul>
<p>Code 属性就是存放方法体里面的代码，但是，并非所有方法表都有 Code 属性，像接口或者抽象方法，他们没有具体的方法体，因此也就不会有 Code 属性了</p>
<p>Code 属性表的结构，如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">数量</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attribute_name_index</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性名索引</td>
</tr>
<tr>
<td style="text-align:center">u4</td>
<td style="text-align:center">attribute_length</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性长度</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">max_stack</td>
<td style="text-align:center">1</td>
<td style="text-align:center">操作数栈深度的最大值</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">max_locals</td>
<td style="text-align:center">1</td>
<td style="text-align:center">局部变量表所需的存续空间</td>
</tr>
<tr>
<td style="text-align:center">u4</td>
<td style="text-align:center">code_length</td>
<td style="text-align:center">1</td>
<td style="text-align:center">字节码指令的长度</td>
</tr>
<tr>
<td style="text-align:center">u1</td>
<td style="text-align:center">code</td>
<td style="text-align:center">code_length</td>
<td style="text-align:center">存储字节码指令</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">exception_table_length</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常表长度</td>
</tr>
<tr>
<td style="text-align:center">exception_info</td>
<td style="text-align:center">exception_table</td>
<td style="text-align:center">exception_length</td>
<td style="text-align:center">异常表</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attributes_count</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性集合计数器</td>
</tr>
<tr>
<td style="text-align:center">attribute_info</td>
<td style="text-align:center">attributes</td>
<td style="text-align:center">attributes_count</td>
<td style="text-align:center">属性集合</td>
</tr>
</tbody>
</table>
</div>
<p>可以看到：Code 属性表的前两项跟属性表是一致的，即 Code 属性表遵循属性表的结构，后面那些则是他自定义的结构</p>
<ul>
<li>InnerClasses 属性</li>
</ul>
<p>为了方便说明特别定义一个表示类或接口的 Class 格式为 C。如果 C 的常量池中包含某个 CONSTANT_Class_info 成员，且这个成员所表示的类或接口不属于任何一个包，那么 C 的 ClassFile 结构的属性表中就必须含有对应的 InnerClasses 属性。InnerClasses 属性是在 JDK 1.1 中为了支持内部类和内部接口而引入的，位于 ClassFile 结构的属性表</p>
<ul>
<li>LineNumberTable 属性</li>
</ul>
<p>LineNumberTable 属性是可选变长属性，位于 Code 结构的属性表</p>
<p>LineNumberTable 属性是<strong>用来描述 Java 源码行号与字节码行号之间的对应关系</strong>，这个属性可以用来在调试的时候定位代码执行的行数</p>
<blockquote>
<p>start_pc，即字节码行号；line_number，即 Java 源代码行号</p>
</blockquote>
<p>在 Code 属性的属性表中，LineNumberTable 属性可以按照任意顺序出现，此外，多个 LineNumberTable 属性可以共同表示一个行号在源文件中表示的内容，即 LineNumberTable 属性不需要与源文件的行一一对应</p>
<p>LineNumberTable 属性表结构：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LineNumberTable_attribute &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">    u2 line_number_table_length;</span><br><span class="line">    &#123;</span><br><span class="line">        u2 start_pc;</span><br><span class="line">        u2 line_number;</span><br><span class="line">    &#125; line_number_table[line_number_table_length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>LocalVariableTable 属性</li>
</ul>
<p>LocalVariableTable 是可选变长属性，位于 Code 属性的属性表中。它被调试器<strong>用于确定方法在执行过程中局部变量的信息。</strong>在 Code 属性的属性中，LocalVariableTable 属性可以按照任意顺序出现。Code 属性中的每个局部变量最多只能有一个 LocalVariableTable 属性。</p>
<ol>
<li>start_pc + length 表示这个变量在字节码中的生命周期起始和结束的偏移位置(this 生命周期从头0到结尾10)</li>
<li>index 就是这个变量在局部变量表中的槽位(槽位可复用)</li>
<li>name 就是变量名称</li>
<li>Descriptor 表示局部变量类型描述</li>
</ol>
<p>LocalVariableTable 属性表结构：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LocalVariableTable_attribute &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">    u2 local_variable_table_length;</span><br><span class="line">    &#123;</span><br><span class="line">        u2 start_pc;</span><br><span class="line">        u2 length;</span><br><span class="line">        u2 name_index;</span><br><span class="line">        u2 descriptor_index;</span><br><span class="line">        u2 index;</span><br><span class="line">    &#125; local_variable_table[local_variable_table_length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Signature 属性</li>
</ul>
<p>Signature 属性是可选的定长属性，位于 ClassFile，field_info 或 method_info 结构的属性表中。在 Java 语言中，任何类、接口、初始化方法或成员的泛型签名如果包含了类型变量(Type Variables)或参数化类型(Parameterized Types)，则 Signature 属性会为它记录泛型签名信息</p>
<ul>
<li>SourceFile 属性</li>
</ul>
<p>SourceFile 属性结构</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名称</th>
<th style="text-align:center">数量</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">attribute_name_index</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性名索引</td>
</tr>
<tr>
<td style="text-align:center">u4</td>
<td style="text-align:center">attribute_length</td>
<td style="text-align:center">1</td>
<td style="text-align:center">属性长度</td>
</tr>
<tr>
<td style="text-align:center">u2</td>
<td style="text-align:center">sourcefile_index</td>
<td style="text-align:center">1</td>
<td style="text-align:center">源码文件索引</td>
</tr>
</tbody>
</table>
</div>
<p>可以看到，其长度总是固定的8个字节</p>
<ul>
<li>其他属性</li>
</ul>
<p>Java 虚拟机中预定义的属性有20多个，这里就不一一介绍了，通过上面几个属性的介绍，只要领会其精髓，其他属性的解读也是易如反掌</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>通过手动去解读字节码文件，终于大概了解到其构成和原理了</p>
<p>实际上，我们可以使用各种工具来帮我们去解读字节码文件，而不用直接去看这些16进制，太繁琐了</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a><strong>小结</strong></h3><p>本章主要介绍了 Class 文件的基本格式</p>
<p>随着 Java 平台的不断发展，在将来，Class 文件的内容也一定会做进一步的扩充，但是其基本的格式和结构不会做重大调整</p>
<p>从 Java 虚拟机的角度看，通过 Class 文件，可以让更多的计算机语言支持 Java 虚拟机平台。因此，Class 文件结构不仅仅是 Java 虚拟机的执行入口，更是 Java 生态圈的基础和核心</p>
<h2 id="使用-javap-指令解析-Class-文件"><a href="#使用-javap-指令解析-Class-文件" class="headerlink" title="使用 javap 指令解析 Class 文件"></a>使用 javap 指令解析 Class 文件</h2><p>自己分析类文件结构太麻烦了！Oracle 提供了 javap 工具</p>
<p>当然这些信息中，有些信息(如本地变量表、指令和代码行偏移量映射表、常量池中方法的参数名称等等)需要在使用 javac 编译成 Class 文件时，指定参数才能输出，比如，你直接 javac xx.java，就不会再生成对应的局部变量表等信息，如果你使用 javac -g xx.java 就可以生成所有相关信息了。如果你使用的是 Eclipse，则默认情况下，Eclipse 在编译时会帮你生成局部变量表、指令和代码行盘一辆映射表等信息</p>
<p>通过反编译生成的汇编代码，我们可以深入的了解 Java 代码的工作机制。比如我们看到的 i++，这行代码实际运行时是先获取变量 i 的值，然后将这个值加1，最后再将加1后的值赋值给变量 i</p>
<h3 id="解析字节码的作用"><a href="#解析字节码的作用" class="headerlink" title="解析字节码的作用"></a>解析字节码的作用</h3><p>通过反编译生成的字节码文件，我们可以深入的了解 Java 代码的工作机制。但是，自己分析类文件结构太麻烦了，除了使用第三方的 jclasslib 工具之外，Oracle 官方也提供了工具：javap</p>
<p>javap 是 JDK 自带的反解析工具。它的作用就是根据 Class 字节码文件，反解析出当前类对应的 Code 区(字节码指令)、局部变量表、异常表和代码行偏移量映射表、常量池等信息</p>
<p>通过局部变量表，我们可以查看局部变量的作用域范围、所在槽位等信息，甚至可以看到槽位复用等信息</p>
<h3 id="javac-g-操作"><a href="#javac-g-操作" class="headerlink" title="javac -g 操作"></a>javac -g 操作</h3><p>解析字节码文件得到的信息中，有些信息(如局部变量表、指令和代码行偏移量映射表、常量池中方法的参数名称等等)需要在使用 javac 编译成 Class 文件时，指定参数才能输出</p>
<p>比如，你直接 javac xx.java，就不会在生成对应的局部变量表等信息，如果你使用 javac -g xx.java 就可以生成所有相关信息了。如果你使用的 Eclipse 或 IDEA，则默认情况下，Eclipse、IDEA 在编译时会帮你生成局部变量表、指令和代码行偏移量映射表等信息</p>
<h3 id="javap-的用法"><a href="#javap-的用法" class="headerlink" title="javap 的用法"></a>javap 的用法</h3><p>javap 的用法格式：javap <options> <classes></p>
<p>其中，classes 就是你要反编译的 Class 文件</p>
<p>在命令行中直接输入 javap 或 javap -help 可以看到 javap 的 options 有如下选项：</p>
<p><img src="https://gitee.com/xlshi/blog_img/raw/master/img/20201020121337.png" alt="image-20201020121336503"></p>
<p>一般常用的是 -v -l -c 三个选项</p>
<p>javap -l 会输出行号和本地变量表信息</p>
<p>javap -c 会对当前 Class 字节码进行反编译生成汇编代码</p>
<p>javap -v classxx 除了包含 -c 内容外，还会输出行号、局部变量表信息、常量池等信息</p>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><ol>
<li>通过 javap 命令可以查看一个 Java 类反汇编得到的 Class 文件版本号、常量池、访问标识、变量表、指令代码行号表等信息。不显式类索引、父类索引、接口索引集合、<clinit>()、<init>()等结构</li>
<li>通过对前面的例子代码反汇编文件的简单分析，可以发现，一个方法的执行通常会涉及下面几块内存的操作<ol>
<li>Java 栈中：局部变量表、操作数栈</li>
<li>Java 堆： 通过对象的地址引用去操作</li>
<li>常量池</li>
<li>其他如帧数据区、方法区的剩余部分等情况，测试中没有显示出来，这里说明一下</li>
</ol>
</li>
<li>平常，我们比较关注的是 Java 类中每个方法的反汇编中的指令操作过程，这些指令都是顺序执行的，可以参考官方文档查看每个指令含义</li>
</ol>
</div><div class="article-tags size-small is-uppercase mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">Class文件结构</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://gitee.com/xlshi/blog_img/raw/master/static/alipay_qcode.jpg" alt="Alipay"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://gitee.com/xlshi/blog_img/raw/master/static/weixin_qcode.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/10/25/%E5%B0%9A%E7%A1%85%E8%B0%B7JVM/%E7%AC%AC%E5%8D%81%E5%85%AD%E7%AB%A0_%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">尚硅谷JVM/第十六章_垃圾回收相关概念</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/10/25/%E5%B0%9A%E7%A1%85%E8%B0%B7JVM/%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0_StringTable/"><span class="level-item">尚硅谷JVM/第十三章_StringTable</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: 'd433799bc29be3278e288b17ca448782',
            repo: 'sxlong0205.github.io',
            owner: 'sxlong0205',
            clientID: '440dd4a8ce4ff973d20a',
            clientSecret: 'e8d19b4861ef6efc0578a8e4a66de578201f0085',
            admin: ["sxlong0205"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="https://s1.ax1x.com/2020/05/04/Y9rl0U.jpg" alt="是龙弟弟呀"></figure><p class="title is-size-4 is-block line-height-inherit">是龙弟弟呀</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Xi&#039;an,Shaanxi</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">303</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">27</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">54</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/sxlong0205" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/sxlong0205"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex" href="#Class-文件结构"><span class="mr-2">1</span><span>Class 文件结构</span></a><ul class="menu-list"><li><a class="is-flex" href="#概述"><span class="mr-2">1.1</span><span>概述</span></a><ul class="menu-list"><li><a class="is-flex" href="#字节码文件的跨平台性"><span class="mr-2">1.1.1</span><span>字节码文件的跨平台性</span></a></li><li><a class="is-flex" href="#Java-的前端编译器"><span class="mr-2">1.1.2</span><span>Java 的前端编译器</span></a></li><li><a class="is-flex" href="#透过字节码指令看代码细节"><span class="mr-2">1.1.3</span><span>透过字节码指令看代码细节</span></a></li></ul></li><li><a class="is-flex" href="#虚拟机的基石：Class-文件"><span class="mr-2">1.2</span><span>虚拟机的基石：Class 文件</span></a><ul class="menu-list"><li><a class="is-flex" href="#字节码文件里是什么？"><span class="mr-2">1.2.1</span><span>字节码文件里是什么？</span></a></li><li><a class="is-flex" href="#什么事字节码指令-byte-code-？"><span class="mr-2">1.2.2</span><span>什么事字节码指令(byte code)？</span></a></li><li><a class="is-flex" href="#如何解读供虚拟机解释执行的二进制字节码？"><span class="mr-2">1.2.3</span><span>如何解读供虚拟机解释执行的二进制字节码？</span></a></li></ul></li><li><a class="is-flex" href="#Class-文件结构-1"><span class="mr-2">1.3</span><span>Class 文件结构</span></a><ul class="menu-list"><li><a class="is-flex" href="#魔数：Class-文件的标志"><span class="mr-2">1.3.1</span><span>魔数：Class 文件的标志</span></a></li><li><a class="is-flex" href="#Class-文件版本号"><span class="mr-2">1.3.2</span><span>Class 文件版本号</span></a></li><li><a class="is-flex" href="#总结："><span class="mr-2">1.3.3</span><span>总结：</span></a></li><li><a class="is-flex" href="#访问标识"><span class="mr-2">1.3.4</span><span>访问标识</span></a></li><li><a class="is-flex" href="#类索引、父类索引、接口索引集合"><span class="mr-2">1.3.5</span><span>类索引、父类索引、接口索引集合</span></a></li><li><a class="is-flex" href="#属性表集合"><span class="mr-2">1.3.6</span><span>属性表集合</span></a></li><li><a class="is-flex" href="#方法表访问标志"><span class="mr-2">1.3.7</span><span>方法表访问标志</span></a></li><li><a class="is-flex" href="#总结"><span class="mr-2">1.3.8</span><span>总结</span></a></li><li><a class="is-flex" href="#小结"><span class="mr-2">1.3.9</span><span>小结</span></a></li></ul></li><li><a class="is-flex" href="#使用-javap-指令解析-Class-文件"><span class="mr-2">1.4</span><span>使用 javap 指令解析 Class 文件</span></a><ul class="menu-list"><li><a class="is-flex" href="#解析字节码的作用"><span class="mr-2">1.4.1</span><span>解析字节码的作用</span></a></li><li><a class="is-flex" href="#javac-g-操作"><span class="mr-2">1.4.2</span><span>javac -g 操作</span></a></li><li><a class="is-flex" href="#javap-的用法"><span class="mr-2">1.4.3</span><span>javap 的用法</span></a></li><li><a class="is-flex" href="#总结-1"><span class="mr-2">1.4.4</span><span>总结</span></a></li></ul></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Algorithm/%E7%AE%97%E6%B3%954%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">算法4笔记</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/IDEA%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"><span class="level-start"><span class="level-item">IDEA使用技巧</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/IDEA%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/%E9%A1%B9%E7%9B%AE%E7%83%AD%E9%83%A8%E7%BD%B2/"><span class="level-start"><span class="level-item">项目热部署</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Java%E6%A1%86%E6%9E%B6/"><span class="level-start"><span class="level-item">Java框架</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Java%E6%A1%86%E6%9E%B6/MyBatis/"><span class="level-start"><span class="level-item">MyBatis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/"><span class="level-start"><span class="level-item">Java虚拟机</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">235</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Linux/Git%E5%AE%89%E8%A3%85/"><span class="level-start"><span class="level-item">Git安装</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/MySQL%E5%AE%89%E8%A3%85/"><span class="level-start"><span class="level-item">MySQL安装</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/Nginx%E5%AE%89%E8%A3%85/"><span class="level-start"><span class="level-item">Nginx安装</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/%E5%AE%89%E8%A3%85Maven/"><span class="level-start"><span class="level-item">安装Maven</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/%E5%AE%89%E8%A3%85Oracle-JDK/"><span class="level-start"><span class="level-item">安装Oracle JDK</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/%E5%AE%89%E8%A3%85Tomcat/"><span class="level-start"><span class="level-item">安装Tomcat</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">虚拟机配置</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Spring%E6%A1%86%E6%9E%B6/"><span class="level-start"><span class="level-item">Spring框架</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Spring%E6%A1%86%E6%9E%B6/SSM%E6%95%B4%E5%90%88/"><span class="level-start"><span class="level-item">SSM整合</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">并发编程</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">设计模式</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"><span class="level-start"><span class="level-item">服务器</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/Tomcat/"><span class="level-start"><span class="level-item">Tomcat</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">机器学习</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9B%BE%E8%A7%A3%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">图解机器学习笔记</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"><span class="tag">Class文件结构</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JDBC/"><span class="tag">JDBC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JDK/"><span class="tag">JDK</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JVM%E4%B8%8EJava%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"><span class="tag">JVM与Java体系结构</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Maven/"><span class="tag">Maven</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MyBatis%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">MyBatis官方文档学习笔记</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MySQL/"><span class="tag">MySQL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nginx/"><span class="tag">Nginx</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSM%E6%95%B4%E5%90%88/"><span class="tag">SSM整合</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/StringTable/"><span class="tag">StringTable</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tomcat/"><span class="tag">Tomcat</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B9%B1%E7%A0%81/"><span class="tag">乱码</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%86%8D%E8%B0%88%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%99%A8/"><span class="tag">再谈类的加载器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"><span class="tag">刷题笔记</span><span class="tag is-grey-lightest">235</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8A%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/"><span class="tag">半监督学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9C%A8%E7%BA%BF%E5%AD%A6%E4%B9%A0/"><span class="tag">在线学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8/"><span class="tag">垃圾回收器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%A6%82%E8%BF%B0/"><span class="tag">垃圾回收概述</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/"><span class="tag">垃圾回收相关概念</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%9B%B8%E5%85%B3%E7%AE%97%E6%B3%95/"><span class="tag">垃圾回收相关算法</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A0%86/"><span class="tag">堆</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%AD%A6%E4%B9%A0/"><span class="tag">多任务学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E8%8A%82%E7%A0%81%E6%8C%87%E4%BB%A4%E9%9B%86%E4%B8%8E%E8%A7%A3%E6%9E%90%E4%B8%BE%E4%BE%8B/"><span class="tag">字节码指令集与解析举例</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B/"><span class="tag">学习模型</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%B9%E8%B1%A1%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D/"><span class="tag">对象实例化内存布局与访问定位</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B8%A6%E7%BA%A6%E6%9D%9F/"><span class="tag">带约束</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BA%8F%E5%88%97%E5%88%86%E7%B1%BB/"><span class="tag">序列分类</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B/"><span class="tag">异常检测</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/"><span class="tag">执行引擎</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"><span class="tag">排序算法</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"><span class="tag">支持向量机</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%B9%E6%B3%95%E5%8C%BA/"><span class="tag">方法区</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%97%A0%E7%9B%91%E7%9D%A3%E9%99%8D%E7%BB%B4/"><span class="tag">无监督降维</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E5%88%86%E7%B1%BB/"><span class="tag">最小二乘分类</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95/"><span class="tag">最小二乘法</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E5%B0%86%E6%8E%A5%E5%8F%A3/"><span class="tag">本地方法将接口</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E6%A0%88/"><span class="tag">本地方法栈</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A6%82%E7%8E%87%E5%88%86%E7%B1%BB%E6%B3%95/"><span class="tag">概率分类法</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%83%AD%E9%83%A8%E7%BD%B2/"><span class="tag">热部署</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9B%91%E7%9D%A3%E9%99%8D%E7%BB%B4/"><span class="tag">监督降维</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98/"><span class="tag">直接内存</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%80%E7%96%8F%E5%AD%A6%E4%B9%A0/"><span class="tag">稀疏学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8/"><span class="tag">程序计数器</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%AD%90%E7%B3%BB%E7%BB%9F/"><span class="tag">类加载子系统</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3/"><span class="tag">类的加载过程详解</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%81%9A%E7%B1%BB/"><span class="tag">聚类</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%88/"><span class="tag">虚拟机栈</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0/"><span class="tag">迁移学习</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E6%A6%82%E8%BF%B0%E5%8F%8A%E7%BA%BF%E7%A8%8B/"><span class="tag">运行时数据区概述及线程</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/"><span class="tag">配置静态IP</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9B%86%E6%88%90%E5%88%86%E7%B1%BB/"><span class="tag">集成分类</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%B2%81%E6%A3%92%E5%AD%A6%E4%B9%A0/"><span class="tag">鲁棒学习</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T09:47:38.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/%E8%AE%BA%E6%96%87/Attention%20Is%20All%20You%20Need/">论文/Attention Is All You Need</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T04:24:41.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/LeetCode/236.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/">LeetCode/236. 二叉树的最近公共祖先</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T04:23:55.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/LeetCode/%E5%89%91%E6%8C%87%20Offer%2068%20-%20II.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/">LeetCode/剑指 Offer 68 - II. 二叉树的最近公共祖先</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T03:53:41.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/LeetCode/235.%20%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/">LeetCode/235. 二叉搜索树的最近公共祖先</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-29T03:53:11.000Z">2020-12-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/12/29/LeetCode/%E5%89%91%E6%8C%87%20Offer%2068%20-%20I.%20%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/">LeetCode/剑指 Offer 68 - I. 二叉搜索树的最近公共祖先</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">53</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">63</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">52</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">67</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Code Dragon" height="28"></a><p class="size-small"><span>&copy; 2021 Code Dragon</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://sxlong0205.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>